# 拼图游戏APP实验方案

> **课程**：移动应用软件开发  
> **平台**：HarmonyOS  
> **开发工具**：DevEco Studio  
> **开发语言**：ArkTS  
> **实验题目**：拼图游戏APP（数字华容道）

---

## 一、实验目标

### 1.1 教学目标
- 掌握 DevEco Studio 开发工具的基本操作
- 了解 HarmonyOS APP 项目的基本结构
- 掌握 Ability 框架和 UI 框架的使用
- 掌握常用组件和布局的使用
- 掌握图像组件的使用和位图处理技术

### 1.2 功能目标
从多张图片中选择一张，分割为多块小图片，打乱后可通过移动拼成原图的游戏应用。

---

## 二、功能架构设计

### 2.1 核心功能（必做，满足基础评分）

#### **功能模块1：多图片选择与切割**
✅ **对应评分点(1)**

**功能描述**：
- 提供3-5张预设图片供用户选择
- 支持将图片分割为N×N的小图片（N为3/4/5）
- 每个小图片上方叠加显示数字标记（1, 2, 3...）

**技术要点**：
- 使用 PixelMap 进行图片处理
- 实现图片分割算法，将原图按网格切分
- 使用 Stack 布局实现图片与数字的叠加显示

---

#### **功能模块2：华容道游戏逻辑**
✅ **对应评分点(2)(3)(4)**

**功能描述**：
- 点击"开始"按钮触发游戏开始
- 图片被打乱后显示在界面上
- 使用"空格移动"机制（经典华容道规则）
- 点击与空格相邻的方块可移动
- 自动检测拼图是否完成

**技术要点**：
- 实现打乱算法（确保生成的拼图有解）
- 相邻性判断算法（上下左右四个方向）
- 状态对比算法（当前状态 vs 目标状态）
- 使用 @State 状态管理实现响应式更新

---

#### **功能模块3：游戏控制**
✅ **对应评分点(5)**

**功能描述**：
- 提供"结束游戏"按钮
- 点击后显示正确的拼图答案
- 提供"重新开始"功能

**技术要点**：
- 游戏状态管理（进行中/已结束/胜利）
- 快速恢复到初始正确状态的功能

---

#### **功能模块4：多页面设计**
✅ **对应评分点(6)**

**功能描述**：
- **主页**：难度选择、图片选择、游戏设置
- **游戏页**：拼图游戏主界面
- **结果页/对话框**：胜利提示、统计信息展示

**技术要点**：
- 使用 @ohos.router 实现页面跳转
- 使用 params 传递页面参数（难度、图片等）
- 使用 CustomDialog 或独立页面展示结果

---

### 2.2 进阶功能（加分项，优先实现）

#### **功能模块5：丝滑交互体验**
✅ **对应评分点(7) - 美观度加分**

**功能描述**：
- **方块移动动画**：点击后平滑滑动到目标位置
- **洗牌动画**：游戏开始时，所有方块依次从原位"飞"到打乱后的位置
- **胜利动画**：拼图完成时，方块间隙逐渐消失，合并成完整图片

**技术要点**：
- 使用 `animateTo` 显式动画 API
- 设置动画曲线（Curve.EaseOut / Curve.FastOutSlowIn）
- 使用 `delay` 属性实现序列动画
- 动态调整 Grid 的 columnsGap 和 rowsGap

---

#### **功能模块6：游戏辅助功能**
✅ **对应评分点(7) - 自定义功能**

**功能描述**：
- **计时器**：显示游戏进行时长（分:秒格式）
- **步数统计**：记录玩家移动次数
- **偷看原图**：长按"眼睛"图标时，底层显示半透明原图

**技术要点**：
- 使用 setInterval 实现计时器
- 使用 Stack 布局叠加原图与拼图
- 使用 onTouch 事件监听按下/抬起
- 使用 opacity 属性配合动画实现"鬼影"效果

---

#### **功能模块7：多难度系统**
✅ **对应评分点(7) - 复杂度加分**

**功能描述**：
- 支持 **3×3**（简单）、**4×4**（中等）、**5×5**（困难）三种难度
- 所有逻辑参数化，不写死难度值

**技术要点**：
- 图片切割函数接收参数 `gridSize: number`
- Grid 的 columnsTemplate 使用动态字符串：`'1fr '.repeat(gridSize)`
- 胜利判断、打乱算法等均基于参数实现
- 展示代码的可复用性和抽象能力

---

### 2.3 创新功能（高分项）

#### **功能模块8：相册选择**
✅ **对应评分点(7) - 自定义功能（重点演示项）**

**功能描述**：
- 除预设图片外，用户可从手机图库选择任意图片作为拼图素材
- 支持模拟器演示（可从电脑拖拽图片到模拟器）

**技术要点**：
- 使用 `@ohos.file.picker.PhotoViewPicker` API
- 调用 `select()` 方法拉起系统图片选择器
- 将返回的 URI 转换为 PixelMap
- 演示动态图片源和位图处理能力

**演示优势**：
- 在模拟器上演示效果极佳且可控
- 完美体现"动态化拼图源"创新点
- 展示 HarmonyOS 系统 API 调用能力

---

#### **功能模块9：响应式布局**
✅ **对应评分点(8) - 多设备协同加分**

**功能描述**：
- 拼图区域在不同屏幕尺寸下自动适配
- 保持正方形比例
- 支持手机、平板等多种设备

**技术要点**：
- 使用 **百分比宽度**：`width('90%')`
- 使用 **aspectRatio**：`.aspectRatio(1.0)` 确保正方形
- 使用 **fr 单位**：Grid 的 columnsTemplate 使用 `'1fr 1fr 1fr'`
- 避免硬编码 px 或 vp 值

**技术优势**：
- 完美解决"硬编码"问题
- 展示声明式 UI 的响应式特性
- 代码优雅且符合 HarmonyOS 设计规范

---

#### **功能模块10：折叠屏适配（可选，最高加分）**
✅ **对应评分点(8) - 多设备协同（满分级别）**

**功能描述**：
- **折叠状态（窄屏）**：单列布局（上下结构）
  - 上方：拼图游戏区
  - 下方：控制按钮 + 信息显示
- **展开状态（宽屏）**：双列布局（左右结构）
  - 左侧：拼图游戏区
  - 右侧：原图预览 + 计时器 + 控制按钮

**技术要点**：
- 使用 `@ohos.mediaquery` API 监听屏幕宽度变化
- 设置断点（如 600vp）
- 使用 `@State` 变量存储当前布局模式
- 使用 `if-else` 动态切换 Row（横向）和 Column（纵向）布局

**演示效果**：
- 在 DevEco Studio 中使用 Foldable 模拟器
- 实时展示折叠/展开时布局的自动切换
- 极具视觉冲击力，展示前沿技术能力

---

## 三、页面结构设计

### 3.1 页面架构图

```
拼图游戏APP
│
├─ 主页 (HomePage.ets)
│   ├─ APP 标题与 Logo
│   ├─ 难度选择区
│   │   └─ Radio 单选按钮组（3×3 / 4×4 / 5×5）
│   ├─ 图片选择区
│   │   ├─ Grid 展示预设图片缩略图
│   │   └─ "从相册选择" 按钮（进阶功能）
│   └─ "开始游戏" 主按钮
│
├─ 游戏页 (GamePage.ets)
│   ├─ 顶部信息栏
│   │   ├─ 计时器显示（00:00 格式）
│   │   ├─ 步数统计（步数：12）
│   │   └─ "偷看原图" 按钮（眼睛图标）
│   │
│   ├─ 中央拼图区（核心区域）
│   │   └─ Grid 布局（N×N 网格）
│   │       ├─ N×N-1 个图片方块（Stack: Image + Text）
│   │       └─ 1 个空格占位符
│   │
│   └─ 底部控制栏
│       ├─ "重新开始" 按钮
│       ├─ "结束游戏" 按钮
│       └─ "返回主页" 按钮
│
└─ 结果展示 (ResultDialog / ResultPage)
    ├─ 胜利动画效果
    ├─ 完整原图展示
    ├─ 游戏统计信息
    │   ├─ 耗时：02:35
    │   └─ 步数：87 步
    ├─ "再玩一次" 按钮
    └─ "返回主页" 按钮
```

---

### 3.2 页面交互流程

```
[启动APP]
    ↓
[主页 - 选择难度和图片]
    ↓ (点击"开始游戏")
[游戏页 - 显示完整拼图]
    ↓ (洗牌动画 1秒)
[游戏页 - 打乱后开始游戏]
    ↓ (玩家移动方块)
    ├─ 点击"偷看" → 显示半透明原图
    ├─ 点击"重新开始" → 重新打乱
    ├─ 点击"结束游戏" → 显示正确答案
    └─ 拼图完成 → 触发胜利判断
        ↓
[结果展示 - 胜利动画 + 统计]
    ↓
    ├─ "再玩一次" → 返回主页
    └─ "返回主页" → 返回主页
```

---

## 四、技术实现路径

### 4.1 核心技术栈

| 技术领域 | 使用的 HarmonyOS API / 技术 |
|---------|---------------------------|
| UI 框架 | ArkTS 声明式 UI（@Component, @State, @Prop） |
| 布局 | Grid, Stack, Row, Column, RelativeContainer |
| 图片处理 | PixelMap, ImageBitmap, Canvas（可选） |
| 动画 | animateTo, @AnimatableExtend（可选） |
| 路由 | @ohos.router |
| 文件选择 | @ohos.file.picker.PhotoViewPicker |
| 响应式布局 | aspectRatio, fr 单位, 百分比布局 |
| 设备适配 | @ohos.mediaquery |
| 定时器 | setInterval, clearInterval |

---

### 4.2 关键算法设计

#### **算法1：图片分割**

**输入**：
- 原始图片 PixelMap
- 网格大小 N（3/4/5）

**输出**：
- N×N 个小图片 PixelMap 数组

**核心思路**：
1. 获取原图宽高（W, H）
2. 计算每个小图片尺寸：`tileW = W/N`, `tileH = H/N`
3. 使用循环（双层 for 循环）
4. 对每个网格位置 (i, j)，裁剪区域 `[i*tileW, j*tileH, tileW, tileH]`
5. 生成新的 PixelMap 对象

---

#### **算法2：打乱生成（确保有解）**

**问题**：随机打乱可能导致无解的拼图

**解决方案**：
- **方法1（推荐）**：从正确状态开始，模拟随机移动 N 次（如100次）
- **方法2**：生成随机排列后，检查逆序对数量的奇偶性（数学方法）

**实现思路（方法1）**：
1. 初始状态：`[0,1,2,3,4,5,6,7,8]`（空格在最后）
2. 循环100次：
   - 找到当前空格位置
   - 随机选择一个与空格相邻的方块
   - 交换它们的位置
3. 最终得到的排列一定有解（因为是从有解状态变换来的）

---

#### **算法3：相邻性判断**

**输入**：
- 当前点击的方块索引 `clickedIndex`
- 空格索引 `emptyIndex`
- 网格大小 `N`

**输出**：
- 布尔值（是否相邻）

**判断逻辑**：
- **同一行且相差1列**：`Math.abs(clickedIndex - emptyIndex) === 1` 且 `Math.floor(clickedIndex/N) === Math.floor(emptyIndex/N)`
- **同一列且相差1行**：`Math.abs(clickedIndex - emptyIndex) === N`

---

#### **算法4：胜利判断**

**核心思路**：
- 维护一个"当前状态数组" `currentState`（如 `[5,2,7,1,0,4,3,6,8]`）
- 维护一个"目标状态数组" `targetState`（如 `[0,1,2,3,4,5,6,7,8]`）
- 比较两个数组是否完全相等

**优化**：
- 不需要每次移动后都比较整个数组
- 可以维护一个"正确方块数量"计数器
- 移动时动态更新，当计数器 === N×N 时即胜利

---

### 4.3 动画实现策略

#### **动画类型1：方块移动动画**

**触发时机**：玩家点击方块且可移动时

**实现方式**：
- 为每个方块维护 `@State` 位置变量（x, y 或 index）
- 使用 `animateTo` 包裹状态更新
- 设置 `duration: 200ms`, `curve: Curve.EaseOut`

**效果**：方块平滑滑动，而非瞬移

---

#### **动画类型2：洗牌动画**

**触发时机**：点击"开始游戏"后

**实现方式**：
- 先显示完整拼图（1秒）
- 为每个方块设置目标位置（打乱后的位置）
- 使用 `animateTo` + `delay: i * 50ms`（依次延迟）
- 所有方块"飞"向目标位置

**效果**：视觉上的"洗牌"过程，增强仪式感

---

#### **动画类型3：胜利动画**

**触发时机**：检测到拼图完成

**实现方式**：
1. **阶段1**：方块间隙消失
   - 将 Grid 的 `columnsGap` 和 `rowsGap` 从 4vp 动画到 0
2. **阶段2**：弹窗出现
   - CustomDialog 使用 `.scale()` 和 `.opacity()` 
   - 从 scale(0) + opacity(0) 动画到 scale(1) + opacity(1)

**效果**：拼图"合体" + 庆祝弹窗"弹出"

---

### 4.4 响应式布局实现

#### **核心原则**

1. **禁止硬编码**：不使用固定的 px 或 vp 值
2. **使用相对单位**：百分比、fr、aspectRatio
3. **容器自适应**：父容器宽度由屏幕决定，子元素相对父容器

#### **拼图区实现**

**期望效果**：
- 在任何屏幕上，拼图区域为屏幕宽度的 90%
- 保持正方形
- 内部网格自动平分

**实现方式**：
```
容器：
  - width('90%')         // 相对屏幕宽度
  - aspectRatio(1.0)     // 强制正方形
  
Grid：
  - columnsTemplate: '1fr 1fr 1fr'  // 3等分（3×3时）
  - rowsTemplate: '1fr 1fr 1fr'
  - width('100%')        // 填满父容器
  - height('100%')
```

**效果**：
- 手机（360vp 宽）：拼图区 = 324vp × 324vp
- 平板（600vp 宽）：拼图区 = 540vp × 540vp
- 自动适配，无需修改代码

---

### 4.5 折叠屏适配实现

#### **技术方案**

**使用 API**：`@ohos.mediaquery`

**核心思路**：
1. 定义断点（如 600vp）
2. 创建媒体查询监听器
3. 监听器回调中更新 `@State` 变量
4. UI 根据状态变量切换布局

**布局策略**：
- **窄屏（< 600vp）**：Column 纵向布局
  ```
  上方：拼图区
  下方：控制区 + 信息区
  ```
  
- **宽屏（≥ 600vp）**：Row 横向布局
  ```
  左侧（70%）：拼图区
  右侧（30%）：原图预览 + 控制区 + 信息区
  ```

#### **实现要点**

1. 定义状态变量：`@State isWideScreen: boolean = false`
2. 创建监听器：`mediaquery.matchMediaSync('(min-width: 600vp)')`
3. 注册回调：`.on('change', (result) => { this.isWideScreen = result.matches })`
4. 条件渲染：
   ```
   if (this.isWideScreen) {
     Row() { ... }  // 宽屏布局
   } else {
     Column() { ... }  // 窄屏布局
   }
   ```

---

## 五、项目文件组织

### 5.1 目录结构

```
entry/src/main/ets/
│
├── pages/                         # 页面目录
│   ├── HomePage.ets               # 主页：难度选择、图片选择
│   ├── GamePage.ets               # 游戏页：核心游戏逻辑
│   └── ResultPage.ets             # 结果页（可选，可用Dialog代替）
│
├── components/                    # 自定义组件目录
│   ├── TileComponent.ets          # 单个拼图方块组件
│   ├── GameTimer.ets              # 计时器组件
│   ├── DifficultySelector.ets     # 难度选择器组件
│   ├── ImageSelector.ets          # 图片选择器组件
│   └── WinDialog.ets              # 胜利对话框组件
│
├── models/                        # 数据模型目录
│   ├── GameState.ets              # 游戏状态数据类
│   │   ├─ gridSize: number        # 难度（3/4/5）
│   │   ├─ tiles: TileData[]       # 方块数据数组
│   │   ├─ emptyIndex: number      # 空格位置
│   │   ├─ moveCount: number       # 步数
│   │   ├─ timeElapsed: number     # 耗时（秒）
│   │   └─ isPlaying: boolean      # 游戏状态
│   │
│   └── TileData.ets               # 方块数据类
│       ├─ id: number              # 方块ID（原始位置）
│       ├─ currentIndex: number    # 当前位置索引
│       ├─ pixelMap: PixelMap      # 方块图片
│       └─ isEmpty: boolean        # 是否为空格
│
├── utils/                         # 工具类目录
│   ├── ImageSlicer.ets            # 图片分割工具
│   │   ├─ sliceImage()            # 切割图片为N×N
│   │   └─ createNumberOverlay()   # 生成数字标记
│   │
│   ├── ShuffleHelper.ets          # 打乱算法工具
│   │   ├─ generateSolvablePuzzle() # 生成有解的打乱状态
│   │   └─ isAdjacent()            # 判断相邻性
│   │
│   ├── WinChecker.ets             # 胜利判断工具
│   │   └─ checkWin()              # 检查是否完成拼图
│   │
│   └── UriConverter.ets           # URI转换工具
│       └─ uriToPixelMap()         # 将相册URI转为PixelMap
│
└── constants/                     # 常量定义目录
    ├── GameConstants.ets          # 游戏常量
    │   ├─ DIFFICULTY_OPTIONS      # 难度选项
    │   ├─ ANIMATION_DURATION      # 动画时长
    │   └─ GRID_GAP               # 方块间隙
    │
    └── ImageAssets.ets            # 图片资源路径
        └─ PRESET_IMAGES          # 预设图片路径数组
```

---

### 5.2 资源文件组织

```
entry/src/main/resources/
│
├── base/
│   ├── element/
│   │   ├── string.json            # 字符串资源
│   │   │   ├─ app_name: "拼图游戏"
│   │   │   ├─ start_game: "开始游戏"
│   │   │   ├─ difficulty_easy: "简单 (3×3)"
│   │   │   └─ ...
│   │   │
│   │   ├── color.json             # 颜色资源
│   │   │   ├─ primary_color: "#1890FF"
│   │   │   ├─ background_color: "#F5F5F5"
│   │   │   └─ ...
│   │   │
│   │   └── float.json             # 尺寸资源
│   │       ├─ title_font_size: 24
│   │       ├─ grid_gap: 4
│   │       └─ ...
│   │
│   └── media/                     # 媒体资源
│       ├── preset_image_1.jpg     # 预设图片1（风景）
│       ├── preset_image_2.jpg     # 预设图片2（动物）
│       ├── preset_image_3.jpg     # 预设图片3（建筑）
│       ├── icon_eye.png           # 眼睛图标（偷看功能）
│       ├── icon_refresh.png       # 刷新图标（重新开始）
│       └── icon_trophy.png        # 奖杯图标（胜利提示）
│
└── dark/                          # 深色模式资源（可选）
    └── element/
        └── color.json             # 深色模式颜色
```

---

### 5.3 配置文件

#### **路由配置**
文件：`entry/src/main/resources/base/profile/main_pages.json`

需要注册的页面：
- `pages/HomePage`
- `pages/GamePage`
- `pages/ResultPage`（如果使用独立页面）

#### **权限配置**（如需相册选择功能）
文件：`entry/src/main/module.json5`

可能需要的权限：
- `ohos.permission.READ_MEDIA`（读取图库）

---

## 六、核心技术难点与解决方案

### 6.1 难点1：确保打乱后的拼图有解

**问题描述**：
- 随机打乱可能生成无解的拼图
- 例如 3×3 拼图有 9!/2 种无解状态

**解决方案**：
- **方案A（推荐）**：模拟移动法
  - 从正确状态开始
  - 随机模拟合法移动 N 次（如 100 次）
  - 保证结果一定有解
  
- **方案B**：逆序对校验法
  - 生成随机排列
  - 计算逆序对数量
  - 若为偶数则有解，奇数则调整

**采用方案**：方案A（代码简单且可靠）

---

### 6.2 难点2：PixelMap 的切割与处理

**问题描述**：
- HarmonyOS 的 PixelMap API 与 Web/Android 不同
- 需要正确使用裁剪 API

**解决方案**：
- 使用 `pixelMap.crop()` 方法
- 参数：`{ x: number, y: number, width: number, height: number }`
- 注意：需要创建新的 PixelMap 对象，原对象不变

**关键步骤**：
1. 获取原图信息：`imageInfo = await pixelMap.getImageInfo()`
2. 计算切割尺寸：`tileSize = imageInfo.size.width / gridSize`
3. 循环裁剪：
   - 区域 = `{ x: col * tileSize, y: row * tileSize, width: tileSize, height: tileSize }`
   - `newPixelMap = await pixelMap.crop(区域)`

---

### 6.3 难点3：Grid 布局的动态配置

**问题描述**：
- Grid 的 columnsTemplate 是字符串类型
- 需要根据难度动态生成

**解决方案**：
- 使用字符串拼接：`'1fr '.repeat(gridSize)`
- 例如：
  - 3×3：`'1fr 1fr 1fr'`
  - 4×4：`'1fr 1fr 1fr 1fr'`
  - 5×5：`'1fr 1fr 1fr 1fr 1fr'`

**注意事项**：
- rowsTemplate 同理
- 确保 Grid 的宽高比为 1:1（使用 aspectRatio）

---

### 6.4 难点4：相册 URI 转 PixelMap

**问题描述**：
- PhotoViewPicker 返回的是 URI 字符串
- 需要转换为 PixelMap 才能处理

**解决方案**：
- 使用 `@ohos.multimedia.image` 模块
- 步骤：
  1. URI → File Descriptor
  2. File Descriptor → ImageSource
  3. ImageSource → PixelMap

**关键 API**：
- `image.createImageSource(fd)`
- `imageSource.createPixelMap(options)`

---

### 6.5 难点5：动画性能优化

**问题描述**：
- 大量方块同时动画可能卡顿
- 尤其是 5×5（25 个方块）

**解决方案**：
- 使用 `@AnimatableExtend` 自定义可动画属性（高级）
- 或使用 `translate()` 代替直接修改位置（性能更好）
- 降低动画帧率或时长

**优化技巧**：
- 仅对移动的方块应用动画，静止方块不动画
- 使用 `renderFit` 模式优化 Image 组件渲染

---

## 七、评分点对照表

| 评分点 | 要求 | 对应功能模块 | 难度 | 优先级 |
|-------|------|------------|------|--------|
| (1) | 多图选择+分割+数字标记 | 功能1 + 功能8（相册） | ★★☆ | P0 |
| (2) | 开始按钮+打乱分布 | 功能2 + 功能5（洗牌动画） | ★★☆ | P0 |
| (3) | 点击移动 | 功能2 + 功能5（移动动画） | ★★☆ | P0 |
| (4) | 自动胜利判断 | 功能2 | ★☆☆ | P0 |
| (5) | 结束按钮 | 功能3 | ★☆☆ | P0 |
| (6) | 多页面设计 | 功能4 | ★☆☆ | P0 |
| (7) | 计时/计分/动画等 | 功能5 + 功能6 + 功能7 | ★★★ | P1 |
| (8) | 多设备协同/复杂度 | 功能9 + 功能10（折叠屏） | ★★★★ | P1 |

**优先级说明**：
- **P0**：必做，满足基础评分（60-75分）
- **P1**：加分项，冲刺高分（75-95分）

---

## 八、创新亮点总结

### 8.1 技术创新

1. **响应式布局的系统性应用**
   - 完全避免硬编码
   - 使用 aspectRatio + fr + 百分比
   - 展示声明式 UI 优势

2. **折叠屏动态适配**
   - 使用 mediaquery API
   - 单列/双列布局自动切换
   - 完美利用屏幕空间

3. **参数化架构设计**
   - 所有逻辑基于 gridSize 参数
   - 代码可复用性强
   - 展示良好的工程能力

---

### 8.2 交互创新

1. **丝滑动画体验**
   - 方块移动动画（200ms）
   - 洗牌序列动画（延迟50ms）
   - 胜利合体动画
   - 弹窗缩放动画

2. **人性化辅助功能**
   - 偷看原图（鬼影效果）
   - 计时器与步数统计
   - 结束游戏查看答案

---

### 8.3 功能创新

1. **动态图片源**
   - 预设图片 + 相册选择
   - 模拟器演示友好
   - 展示 PixelMap 处理能力

2. **多难度系统**
   - 3×3 / 4×4 / 5×5
   - 一套代码适配三种难度
   - 展示算法抽象能力

---

## 九、实验预期成果

### 9.1 最终交付物

1. **可运行的 APP**
   - 在模拟器上流畅运行
   - 无明显 Bug
   - 所有核心功能可用

2. **源代码**
   - 结构清晰的项目目录
   - 注释完整的关键代码
   - 符合 ArkTS 编码规范

3. **实验报告**
   - 功能说明
   - 技术难点分析
   - 创新点总结
   - 运行截图

---

### 9.2 演示重点

#### **必演示项（3-5分钟）**

1. **基础游戏流程**（1分钟）
   - 选择难度 → 选择图片 → 开始游戏
   - 移动方块 → 完成拼图 → 胜利提示

2. **动画效果**（1分钟）
   - 洗牌动画
   - 移动动画
   - 胜利动画

3. **相册选择**（1分钟）
   - 从电脑拖拽图片到模拟器
   - 在 APP 中选择刚拖入的图片
   - 使用自定义图片玩游戏

#### **加分演示项（2-3分钟）**

4. **多难度切换**（30秒）
   - 展示 3×3 / 4×4 / 5×5 三种难度

5. **辅助功能**（30秒）
   - 偷看原图
   - 计时器与步数统计

6. **折叠屏适配**（1分钟）
   - 切换到 Foldable 模拟器
   - 展示折叠状态（单列布局）
   - 点击"展开"按钮
   - 布局实时切换为双列

7. **响应式布局**（30秒）
   - 切换不同设备模拟器（Phone / Tablet）
   - 展示拼图区自动适配且保持正方形

---

### 9.3 预期得分

| 得分段 | 条件 | 实现方案 |
|-------|------|---------|
| 60-70分 | 完成所有基础功能（评分点1-6） | 仅实现 P0 功能 |
| 70-80分 | 基础功能 + 部分加分项（计时/动画） | P0 + 功能5/6 |
| 80-90分 | 基础功能 + 多个加分项 + 美观界面 | P0 + 功能5/6/7/9 |
| 90-95分 | 所有功能 + 创新点突出 + 折叠屏适配 | P0 + P1（含功能10） |
| 95-100分 | 上述 + 代码质量优秀 + 演示完美 | 全功能 + 优秀工程实践 |

**本方案预期得分区间**：**90-95分**

---

## 十、开发建议

### 10.1 开发顺序

**阶段一：搭建框架（Day 1）**
- 创建三个页面基础结构
- 配置路由
- 实现页面跳转

**阶段二：核心功能（Day 2-3）**
- 实现图片分割工具类
- 实现华容道游戏逻辑
- 完成 Grid 布局和方块渲染

**阶段三：动画优化（Day 4）**
- 添加移动动画
- 添加洗牌动画
- 添加胜利动画

**阶段四：进阶功能（Day 5-6）**
- 实现相册选择
- 实现计时器和步数统计
- 实现响应式布局
- 实现多难度系统

**阶段五：高级适配（Day 7）**
- 实现折叠屏适配
- 优化界面美观度
- 测试和 Bug 修复

---

### 10.2 调试建议

1. **使用 DevEco Studio 的 Previewer**
   - 快速预览 UI 效果
   - 无需启动模拟器

2. **使用 console.log 调试**
   - 打印关键变量状态
   - 追踪算法执行流程

3. **使用断点调试**
   - 在关键函数设置断点
   - 查看运行时状态

4. **使用多种模拟器测试**
   - Phone 模拟器（基础）
   - Tablet 模拟器（测试响应式）
   - Foldable 模拟器（测试折叠屏）

---

### 10.3 常见问题预防

**问题1：图片加载失败**
- 检查资源路径是否正确
- 使用 `$r('app.media.xxx')` 引用资源

**问题2：动画卡顿**
- 减少同时动画的元素数量
- 使用 translate 代替位置变化
- 降低动画时长

**问题3：Grid 布局错乱**
- 检查 columnsTemplate 和 rowsTemplate
- 确保 width 和 height 都设置了
- 检查 aspectRatio 是否生效

**问题4：相册选择报错**
- 检查权限是否配置
- 检查 API 调用是否正确
- 使用 try-catch 捕获异常

---

## 十一、总结

本实验方案设计了一个功能完整、技术先进、体验优秀的拼图游戏 APP，具有以下特点：

### **核心优势**

1. **完全覆盖所有评分点**
   - 基础功能（评分点 1-6）：100% 覆盖
   - 加分功能（评分点 7-8）：多项超额完成

2. **技术亮点突出**
   - 响应式布局（解决硬编码问题）
   - 折叠屏适配（展示前沿技术）
   - 相册选择（动态图片源）
   - 参数化设计（代码可复用性）

3. **演示效果出色**
   - 丝滑动画（视觉享受）
   - 模拟器友好（相册选择可拖拽图片）
   - 折叠屏实时切换（视觉冲击力）

4. **工程质量高**
   - 清晰的目录结构
   - 模块化的组件设计
   - 完整的工具类封装

### **创新性总结**

本方案的创新点不是"花哨的新功能"，而是：
- 对 HarmonyOS 声明式 UI 特性的**深度应用**
- 对响应式布局和设备适配的**系统性实现**
- 对用户体验细节的**精心打磨**

这些都是《移动应用软件开发》课程希望学生掌握的核心能力。

---

**方案制定完成，祝实验顺利！** 🎉

